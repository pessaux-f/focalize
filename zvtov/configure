#!/bin/sh

#**********************************************************************#
#                                                                      #
#                        FoCaLize compiler                             #
#                                                                      #
#            François Pessaux                                          #
#            Pierre Weis                                               #
#            Damien Doligez                                            #
#                               LIP6  --  INRIA Rocquencourt           #
#                                                                      #
#  Copyright 2008 INRIA                                                #
#  Distributed only by permission.                                     #
#                                                                      #
#**********************************************************************#

#  $Id: configure,v 1.14 2008-11-30 11:48:31 weis Exp $

prefix=/usr/local

set_dirs () {
  bindir="${prefix}/bin"
}

set_dirs
xmlrpc=false

while : ; do
  case $# in 0) break;; esac

  case $1 in
  -bindir | --bindir) bindir="$2"; shift;;
  -prefix | --prefix) prefix="$2"; set_dirs; shift;;
  -xmlrpc | --xmlrpc) xmlrpc=true;;
  -help | --help)
     echo "usage: ./configure [options]"
     echo "options are:"
     echo "  [-]-bindir <directory>";
     echo "    set the binary directory for installation (default ${bindir})."
     echo "  [-]-prefix <directory>";
     echo "    set the directory prefix for installation (default ${prefix})."
     echo "  [-]-xmlrpc";
     echo "    configure with XMLRPC option on."
     echo "  [-]-help";
     echo "    display help and exit"
     exit 0
     ;;
  *) echo "./configure: bad option '$1'" >&2
     echo "For help, use ./configure -help" >&2
     exit 2
     ;;
  esac
  shift
done

if $xmlrpc; then
  XMLRPCFILE=xmlrpc
  XMLRPCFLAGS="`ocamlfind query -r -i-format xmlrpc | tr '\012' ' '`"
  XMLRPCLINK="`ocamlfind query -r -predicates byte -a-format xmlrpc | tr '\012' ' '`"
else
  XMLRPCFILE=
  XMLRPCFLAGS=
  XMLRPCLINK=
fi

: >.config_var

echo "prefix=$prefix" >>.config_var
echo "bindir=$bindir" >>.config_var
echo "XMLRPCFILE=$XMLRPCFILE" >>.config_var
echo "XMLRPCFLAGS=$XMLRPCFLAGS" >>.config_var
echo "XMLRPCLINK=$XMLRPCLINK" >>.config_var

echo "Configuration summary for zvtov:"
cat .config_var
