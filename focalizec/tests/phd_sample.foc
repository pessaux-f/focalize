use "basics" ;;
open "basics" ;;

species Setoide inherits Basic_object =
  sig ( = ) : Self -> Self -> bool ;
  sig element : Self ;
  let different (x, y) = basics#not_b (x = y) ;

  property refl : all x in Self, x = x ;
  property symm : all x y in Self, Self!( = ) (x, y) -> y = x ;
end ;;

species Monoide inherits Setoide =
  sig ( * ) : Self -> Self -> Self ;
  sig un : Self ;
  let element = Self! un * !un ;
end ;;

species Setoide_produit (A is Setoide, B is Setoide) inherits Setoide =
  rep = (A * B) ;

  let ( = ) (x, y) =
     and_b
       (A!( = ) (basics#first (x), basics#first (y)),
	B!( = ) (scnd (x), scnd (y))) ;
  let creer (x, y) = basics#crp (x, y) ;
  let element = Self!creer (A!element, B!element) ;
  let print (x) =
     sc ("(",
	 sc (A!print (first (x)),
	     sc (",",
		 sc (B!print (scnd (x)),
		     ")")))) ;

  (*
  proof of refl = by definition of ( = ) ;
  proof of symm = assumed ;
  *)
end ;;


species Monoide_produit (A is Monoide, B is Monoide)
  inherits Monoide, Setoide_produit (A, B) =

  let un = !creer (A!un, B!un) ;
  let ( * ) (x, y) =
     crp (A!( * ) (first (x), first (y)),
	  B!( * ) (scnd (x), scnd (y))) ;
end ;;

species Entiers inherits Monoide =
  rep = int ;

  let un = 1 ;
  let ( * ) = basics#int_mult ;
end ;;
