use "basics" ;;
open "basics" ;;

(* *********************************************************** *)
(* Failure required                                            *)
(* Example showing the need for methods to be not polymorphic. *)
(* *********************************************************** *)

species Poly =
  let id (x) = x ;
end ;;

species Id_bool (X is Poly) =
  rep = basics#unit ;

  let elt = X!id (true) ;
end ;;

species Id_int inherits Poly =
  rep = basics#unit ;

  let id (x) = if true then 1 else x ;
end ;;

collection Coll_int implements Id_int ;;

(* Must fail !!!!!!!!!! *)
collection Error implements Id_bool (Coll_int) ;;

