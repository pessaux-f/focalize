external type string = | caml -> "string" ;;
external type bool = | caml -> "bool" ;;
external type int = | caml -> "int" ;;
external type list ('a) = | caml -> "list" ;;
external value foc_error : string -> 'a =  | caml -> "" ;;

(* ************************************************************* *)
(* Must pass.                                                    *)
(* Example from Virgile Prevosto's Phd, section 6.4.3, page 115. *)
(* ************************************************************* *)
species Basic_object =
  let print (x in Self) = "<abst>" ;
  let parse (x in string) in Self = #foc_error ("not parsable") ;
  let equal (x in Self, y) =
     let useless = if true then x else y in
     true ;
end ;;

species S inherits Basic_object =
  sig a : Self ;
  sig op : Self -> Self ;
  let c = op (a) ;
  sig p1 : Self -> prop ;
  sig p2 : Self -> prop ;
  property p1_p2 : all x in Self, p2 (x) -> p1 (x) ;
  property op_spec : all x in Self, p1 (x) -> p2 (op (x)) ;
  property a_spec : p1 (a) ;
  theorem t1 : p2 (c) proof : by definition of c ;
  theorem t2 : p1 (c) proof : by property t1, p1_p2 ;
end ;;
